---
title: "AirLines"
---
  
  ```
{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```






```{r}

library(ggplot2)
library(dplyr)
library(readr)

# Carica il dataset
data <- read.csv("Dataset/airline_passenger_satisfaction.csv") 

# Controlla i primi record
head(data)

```

Correlation matrix
```{r}


# Caricare le librerie necessarie
library(readr)
library(dplyr)
library(corrplot)
library(ggplot2)



# Trasformazione delle variabili categoriche in variabili dummy
train_dummy <- model.matrix(~ . - 1, data=data)

# Calcolo della matrice di correlazione
cor_matrix <- cor(train_dummy)

# Visualizzazione della matrice di correlazione con corrplot
corrplot(cor_matrix, method="color", type="upper", tl.cex=0.6, tl.col="black")

# Estrarre le correlazioni con la variabile Satisfaction
cor_satisfaction <- as.data.frame(cor_matrix[,"SatisfactionSatisfied"])

# Rimuovere la correlazione della variabile con sé stessa
cor_satisfaction <- cor_satisfaction[rownames(cor_satisfaction) != "SatisfactionSatisfied", , drop=FALSE]

# Ordina le variabili in base alla loro correlazione con Satisfaction
cor_satisfaction <- cor_satisfaction[order(-abs(cor_satisfaction$SatisfactionSatisfied)), , drop=FALSE]

# Visualizzare le prime 10 variabili con la maggiore correlazione positiva
top_positive <- cor_satisfaction %>% filter(SatisfactionSatisfied > 0) %>% head(10)
print("Top 10 variabili con correlazione positiva:")
print(top_positive)

# Visualizzare le prime 10 variabili con la maggiore correlazione negativa
top_negative <- cor_satisfaction %>% filter(SatisfactionSatisfied < 0) %>% head(10)
print("Top 10 variabili con correlazione negativa:")
print(top_negative)

# Creare un grafico a barre per le variabili con maggiore correlazione positiva e negativa
cor_satisfaction$Variable <- rownames(cor_satisfaction)

# Seleziona le top 10 variabili positive e negative
top_correlations <- rbind(head(cor_satisfaction[order(-cor_satisfaction$SatisfactionSatisfied), ], 10),
                          head(cor_satisfaction[order(cor_satisfaction$SatisfactionSatisfied), ], 10))

# Grafico a barre
ggplot(top_correlations, aes(x=reorder(Variable, SatisfactionSatisfied), y=SatisfactionSatisfied)) +
  geom_bar(stat="identity", fill="steelblue") +
  coord_flip() +
  labs(title="Top 10 Correlazioni con Satisfaction",
       x="Variabile",
       y="Correlazione") +
  theme_minimal()

# Visualizzare la matrice di correlazione con le correlazioni
print(cor_satisfaction)

```














```{r}
# Conta il numero di clienti per ogni livello di soddisfazione
satisfaction_counts <- data %>%
  count(Satisfaction)

# Crea un grafico a barre
ggplot(satisfaction_counts, aes(x = Satisfaction, y = n, fill = Satisfaction)) +
  geom_bar(stat = "identity") +
  scale_fill_viridis_d() +
  labs(title = "Distribuzione della Soddisfazione dei Clienti",
       x = "Soddisfazione",
       y = "Numero di Clienti") +
  theme_minimal()

```




```{r}
# Grafico di soddisfazione per tipo di viaggio
ggplot(data, aes(x = `Type.of.Travel`, fill = Satisfaction)) +
  geom_bar(position = "dodge") +
  scale_fill_viridis_d() +
  labs(title = "Soddisfazione per Tipo di Viaggio",
       x = "Tipo di Viaggio",
       y = "Numero di Clienti") +
  theme_minimal()

```



```{r}
# Grafico di soddisfazione per classe di volo
ggplot(data, aes(x = Class, fill = Satisfaction)) +
  geom_bar(position = "dodge") +
  scale_fill_viridis_d() +
  labs(title = "Soddisfazione per Classe di Volo",
       x = "Classe di Volo",
       y = "Numero di Clienti") +
  theme_minimal()

```

```{r}
# Grafico di soddisfazione per tipo di cliente
ggplot(data, aes(x = `Customer.Type`, fill = Satisfaction)) +
  geom_bar(position = "dodge") +
  scale_fill_viridis_d() +
  labs(title = "Soddisfazione per Tipo di Cliente",
       x = "Tipo di Cliente",
       y = "Numero di Clienti") +
  theme_minimal()

```



```{r}
# Grafico di soddisfazione in base all’età
ggplot(data, aes(x = Satisfaction, y = Age, fill = Satisfaction)) +
  geom_boxplot() +
  scale_fill_viridis_d() +
  labs(title = "Soddisfazione in base all’Età",
       x = "Soddisfazione",
       y = "Età") +
  theme_minimal()

```

```{r}

```


